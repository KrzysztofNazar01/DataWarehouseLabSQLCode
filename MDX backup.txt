// 1. Jaka jest różnica w całkowitym opóźnieniu pociągów między tym,
// a poprzednim miesiącem?
// GOTOWE
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Suma opoznien]
)'
 MEMBER [Difference between months] AS
'(
	[Measures].[Suma opoznien] - (ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Suma opoznien])
)'
SELECT
	{
		(
			[Data].[HierarchiaDaty].[Rok].[2021].Children
		)
	}
	ON ROWS,
	{
		([Measures].[Suma opoznien]),
		[Prev month amount],
		[Difference between months]
	}
	ON COLUMNS
FROM [Trains 3];



// 2. Na jakiej trasie najbardziej zmniejszyło się
// sumaryczne opóźnienie w porównaniu z miesiącem poprzednim?
// brakuje odwolania sie do trasy 
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Suma opoznien]
)'
SELECT
	{
		(
			[Data].[HierarchiaDaty].[Rok].[2021].Children
		)
	}
	ON ROWS,
	{
		([Measures].[Suma opoznien]),
		[Prev month amount]
		
	}
	ON COLUMNS
FROM [Trains 3];


// 3. Jaki typ pociągu ma najmniejsze średnie opóźnienie w poszczególnych miesiącach?
// brakuje odwolania sie do typu pociagu
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Srednie opoznienie]
)'
SELECT
	{
		(
			[Data].[HierarchiaDaty].[Rok].[2021].[Luty]
		)
	}
	ON ROWS,
	{
	
		([Measures].[Srednie opoznienie]),
		[Prev month amount]
		
	}
	ON COLUMNS
FROM [Trains 3];


// 4. Jak na przestrzeni miesięcy zmienia się średni czas opóźnienia
// dla pociągów wiozących dany typ towaru?
// GOTOWE

SELECT
	{
		[Data].[HierarchiaDaty].[Rok].[2021].[Luty]
	}
ON ROWS,
	{
		([Pociagi].[Typ Towaru].Members, // zamiast Members mozna wstawic typ towaru
		[Measures].[Srednie opoznienie])
	}
ON COLUMNS

FROM [Trains 3];


// 5. Jaka jest różnica pomiędzy miesiącami w ilości przejazdów,
// na których nie wystąpiło żadne opóźnienie?




// 6. Jak na przestrzeni miesięcy zmienia się liczba przejazdów,
// gdzie opóźnienie nie przekracza 30 minut, pomimo wystąpienia awarii?
// trzeba uzyc funkcji filter do sprwadzenia, czy opoznienie przekracza 30 minut

SELECT
	{
		//[Data].[HierarchiaDaty].[Rok].[2021].[Luty]
		(
		[Przejazdy].[Id Przejazdu].Children,
		[Przejazdy].[Opoznienie].Children,
		[Przejazdy].[Masa Towaru].Children
		)
		
	}
ON ROWS,
	{
		//[Measures].[Ilosc przejazdow]

	} //HAVING [Measures].[Male opoznienie]
ON COLUMNS
FROM [Trains 3]
WHERE { 
//[Przejazdy].[Czy Wystapila Awaria].[False]
		}
;



/*
SELECT
	{
		(
		[Przejazdy].[Id Przejazdu].Children,
		[Przejazdy].[Opoznienie].Children,
		[Przejazdy].[Masa Towaru].Children
		)
	}
ON ROWS,
	{
		[Measures].[Male opoznienie]
	} 
ON COLUMNS
FROM [Trains 3]

;
*/

// 7. Jak zmieniła się średnia liczba pasażerów
// przewożonych na danej trasie w tym i poprzednim miesiącu?
// DODAĆ MERGE PO ID TRASY

WITH MEMBER [Prev month amount] AS
'(ParallelPeriod([Data].[HierarchiaDaty].[Miesiac],
1,
[Data].[HierarchiaDaty].CurrentMember),
[Measures].[Srednia ilosc pasazerow])'
SELECT
	{
		[Data].[HierarchiaDaty].[Rok].[2021].[Luty]
	}
	ON ROWS,
	{
		[Measures].[Srednia ilosc pasazerow],
		[Prev month amount]
	}
	ON COLUMNS
FROM [Trains 3];



// 8. Jaki typ towaru był najczęściej przewożony w poszczególnych miesiącach?





// 9. Jak zmienia się masa przewożonego towaru na danej trasie w tym i poprzednim miesiącu?





// 10. Na jakiej trasie w poszczególnych miesiącach przewiezionych zostało najwięcej osób?





// 11. Ile w poszczególnych miesiącach było pociągów, 
// które miały zapełnione więcej niż 50% miejsc siedzących?




