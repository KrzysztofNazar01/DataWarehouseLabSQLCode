// 1. Jaka jest różnica w całkowitym opóźnieniu pociągów między tym,
// a poprzednim miesiącem?
// GOTOWE
/*
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Suma opoznien]
)'
 MEMBER [Difference between months] AS
'(
	[Measures].[Suma opoznien] - (ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Suma opoznien])
)'
SELECT
	{
		(
			[Data].[HierarchiaDaty].[Rok].[2021].Children
		)
	}
	ON ROWS,
	{
		([Measures].[Suma opoznien]),
		([Prev month amount]),
		[Difference between months]
	}
	ON COLUMNS
FROM [Trains 3];

*/

// 2. Na jakiej trasie najbardziej zmniejszyło się
// sumaryczne opóźnienie w porównaniu z miesiącem poprzednim?
// czy powinnismy sie odnosic do stacji poczatkowej oraz stacji koncowej? --> jeśli nie to gotowe
/*
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Suma opoznien]
)'
 MEMBER [Difference between months] AS
'(
	[Measures].[Suma opoznien] - [Prev month amount]
)'
SELECT
	{
		topcount(order([Trasy].[Id Trasy].Children, [Difference between months] , desc), 1)
}
	ON ROWS,
	{
		([Difference between months])
		}

	ON COLUMNS
FROM [Trains 3];

*/
// 3. Jaki typ pociągu ma najmniejsze średnie opóźnienie w poszczególnych miesiącach?
// gotowe
/*
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Srednie opoznienie]
)'
SELECT
	topcount( 
			order(
				[Pociagi].[Typ].Children
				, ([Prev month amount]
				, [Data].[HierarchiaDaty].[Rok].[2021].[Marzec])
				, desc
				)
			, 1
			)
	ON ROWS,
	
	([Prev month amount], [Data].[HierarchiaDaty].[Rok].[2021].[Marzec])	
	
	ON COLUMNS
FROM [Trains 3];
*/

// 4. Jak na przestrzeni miesięcy zmienia się średni czas opóźnienia
// dla pociągów wiozących dany typ towaru?
// GOTOWE
/*
SELECT
	{
		[Data].[HierarchiaDaty].[Rok].[2021].[Luty]
	}
ON ROWS,
	{
		([Pociagi].[Typ Towaru].Members, // zamiast Members mozna wstawic typ towaru
		[Measures].[Srednie opoznienie])
	}
ON COLUMNS

FROM [Trains 3];
*/

// 5. Jaka jest różnica pomiędzy miesiącami w ilości przejazdów,
// na których nie wystąpiło żadne opóźnienie?




// 6. Jak na przestrzeni miesięcy zmienia się liczba przejazdów,
// gdzie opóźnienie nie przekracza 30 minut, pomimo wystąpienia awarii?
// trzeba dodac count, żeby policzyło ilość kolumn
WITH MEMBER [Prev month amount] AS
'(
	ParallelPeriod(
					[Data].[HierarchiaDaty].[Miesiac],
					1,
					[Data].[HierarchiaDaty].CurrentMember
				  ),
		[Measures].[Przejazdy Count]
)'

MEMBER [przejazdy z malym spoznieniem] as 
'
count (
Filter(
		[Przejazdy].[Id Przejazdu].Children,
		[Przejazdy].[Opoznienie] <= 30)
		)
'

SELECT

		(
		 [Prev month amount]
		)
ON ROWS,
	{
		

Filter(
		[Przejazdy].[Id Przejazdu].Children,
		[Przejazdy].[Opoznienie] <= 30
		)
		
	
	
	}

	
ON COLUMNS
FROM [Trains 3];


/*
SELECT
	{
		(
		[Przejazdy].[Id Przejazdu].Children,
		[Przejazdy].[Opoznienie].Children,
		[Przejazdy].[Masa Towaru].Children
		)
	}
ON ROWS,
	{
		[Measures].[Male opoznienie]
	} 
ON COLUMNS
FROM [Trains 3]

;
*/

// 7. Jak zmieniła się średnia liczba pasażerów
// przewożonych na danej trasie w tym i poprzednim miesiącu?
// DODAĆ MERGE PO ID TRASY
/*
WITH MEMBER [Prev month amount] AS
'(ParallelPeriod([Data].[HierarchiaDaty].[Miesiac],
1,
[Data].[HierarchiaDaty].CurrentMember),
[Measures].[Srednia ilosc pasazerow])'
SELECT
	{
		[Data].[HierarchiaDaty].[Rok].[2021].[Luty]
	}
	ON ROWS,
	{
		[Measures].[Srednia ilosc pasazerow],
		[Prev month amount]
	}
	ON COLUMNS
FROM [Trains 3];

*/

// 8. Jaki typ towaru był najczęściej przewożony w poszczególnych miesiącach?
/*
WITH MEMBER [Prev month amount] AS
'(ParallelPeriod([Data].[HierarchiaDaty].[Miesiac],
1,
[Data].[HierarchiaDaty].CurrentMember),
[Measures].[Suma przewozonego towaru])'
MEMBER [Typ w danym miesiacu] AS // tutaj zmien miesiac
'(
	[Data].[HierarchiaDaty].[Rok].[2021].[Marzec]
	, [Prev month amount]
)'
SELECT
		topcount(
				ORDER(
						  [Pociagi].[Typ Towaru].Children
						, [Typ w danym miesiacu]
						, DESC
					)
				, 1
				)
	ON ROWS,
		[Typ w danym miesiacu]
	ON COLUMNS
FROM [Trains 3];

*/

// 9. Jak zmienia się masa przewożonego towaru na danej trasie w tym i poprzednim miesiącu?
// chyba git

/*
WITH MEMBER [Prev month amount] AS
'(ParallelPeriod([Data].[HierarchiaDaty].[Miesiac],
1,
[Data].[HierarchiaDaty].CurrentMember),
[Measures].[Suma przewozonego towaru])'
MEMBER [Difference between months] AS
'(
	[Measures].[Suma przewozonego towaru] - [Prev month amount]
)'
SELECT
		[Trasy].[Id Trasy].Children
	ON ROWS,
	
		(
			[Data].[HierarchiaDaty].[Rok].[2021].Children
			, [Difference between months]
		)
	
	ON COLUMNS
FROM [Trains 3];

*/

// 10. Na jakiej trasie w poszczególnych miesiącach przewiezionych zostało najwięcej osób?
// gotowe
/*
WITH MEMBER [Prev month amount] AS
'(ParallelPeriod([Data].[HierarchiaDaty].[Miesiac],
1,
[Data].[HierarchiaDaty].CurrentMember),
[Measures].[Suma przewiezionych pasazerow])'
MEMBER [Difference between months] AS
'(
	[Measures].[Suma przewiezionych pasazerow] - [Prev month amount]
)'
SELECT
		topcount(
				order( [Trasy].[Id Trasy].Children
					, ([Data].[HierarchiaDaty].[Rok].[2021].[Luty], [Difference between months]) 
					, desc
					)
				, 1)
	ON ROWS,
	
		([Data].[HierarchiaDaty].[Rok].[2021].[Luty], [Difference between months])
	
	ON COLUMNS
FROM [Trains 3];
*/

// 11. Ile w poszczególnych miesiącach było pociągów, 
// które miały zapełnione więcej niż 50% miejsc siedzących?





